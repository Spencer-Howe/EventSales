{% extends "base.html" %}

{% block title %}Crypto Admin{% endblock %}

{% block content %}
<div class="container">
  <h1>Crypto Payment Admin</h1>
  
  {% if bookings %}
    <p>Found {{ bookings|length }} pending crypto payments</p>
    
    {% for booking in bookings %}
    <div class="card mb-3">
      <div class="card-body">
        <h5>Order: {{ booking.order_id }}</h5>
        
        <p><strong>Customer:</strong> {{ booking.customer.name if booking.customer else 'No name' }}</p>
        <p><strong>Email:</strong> {{ booking.customer.email if booking.customer else 'No email' }}</p>
        <p><strong>Tickets:</strong> {{ booking.tickets }}</p>
        
        {% if booking.payments %}
          <p><strong>Amount:</strong> ${{ booking.payments[0].amount_paid }}</p>
          <p><strong>Currency:</strong> {{ booking.payments[0].crypto_currency }}</p>
          {% if booking.payments[0].transaction_hash %}
            <p><strong>Hash:</strong> {{ booking.payments[0].transaction_hash }}</p>
          {% endif %}
        {% endif %}
        
        <a href="{{ url_for('crypto.confirm_crypto_payment', order_id=booking.order_id) }}" 
           class="btn btn-success"
           onclick="return confirm('Confirm this payment?')">
          Confirm Payment
        </a>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <p>No pending crypto payments.</p>
  {% endif %}
  
  <a href="{{ url_for('admin.index') }}" class="btn btn-secondary">Back to Admin</a>
</div>
{% endblock %}